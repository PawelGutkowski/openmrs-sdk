sudo: required

services:
  - docker
language: java
install :
  - mvn org.openmrs.maven.plugins:openmrs-sdk-maven-plugin:setup-sdk -DbatchAnswers=n
script:
  - mvn install -DskipTests
  - mvn org.openmrs.maven.plugins:openmrs-sdk-maven-plugin:3.2.2-SNAPSHOT:build-distro -Ddistro=referenceapplication:2.5-SNAPSHOT
  - cd referenceapplication-2.5-SNAPSHOT
  - docker-compose up
deploy:
  provider: script
  script: ./deploy.sh
  skip_cleanup: true
  on:
    tags: true
